# Migration `20200831085234-m2`

This migration has been generated by sebastianrcnt at 8/31/2020, 5:52:34 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

ALTER TABLE "Result" ADD COLUMN "userEmail" TEXT ;

PRAGMA foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200830173747-json-is-not-unique..20200831085234-m2
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "sqlite"
-  url = "***"
+  url = "***"
 }
 model Experiment {
   id          String    @default("unset") @id
@@ -15,9 +15,9 @@
   fileId      String    @default("unset")
   fileName    String?
   User        User?     @relation(fields: [userEmail], references: [email])
   Result      Result[]
-  Projects    Project[]
+  Project     Project[]
 }
 model User {
   email      String       @default("unset@monet.com") @id
@@ -29,28 +29,28 @@
   Project    Project[]
   Result     Result[]
 }
+model Project {
+  id          String       @default("unset") @id
+  description String?
+  agreement   String?
+  public      Int          @default(0)
+  userEmail   String?
+  name        String?
+  User        User?        @relation(fields: [userEmail], references: [email])
+  Result      Result[]
+  Experiment  Experiment[]
+}
+
 model Result {
   experimentId String?
   projectId    String?
   userEmail    String?
-  json         String?     @default("{}")
+  json         String?     @default("{}") @unique
   timestamp    String?
   id           Int         @default(autoincrement()) @id
   done         Int         @default(0)
   Experiment   Experiment? @relation(fields: [experimentId], references: [id])
   Project      Project?    @relation(fields: [projectId], references: [id])
   User         User?       @relation(fields: [userEmail], references: [email])
 }
-
-model Project {
-  id          String       @default("unset") @id
-  description String?
-  agreement   String?
-  public      Int          @default(0)
-  userEmail   String?
-  name        String?
-  User        User?        @relation(fields: [userEmail], references: [email])
-  Result      Result[]
-  Experiments Experiment[]
-}
```


