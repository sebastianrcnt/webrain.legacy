# Migration `20200901042124-psql1`

This migration has been generated by sebastianrcnt at 9/1/2020, 1:21:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Experiment" (
"id" text   NOT NULL DEFAULT E'unset',
"userEmail" text   ,
"name" text   NOT NULL DEFAULT E'unset',
"description" text   ,
"fileId" text   NOT NULL DEFAULT E'unset',
"fileName" text   ,
"json" text   DEFAULT E'{}',
PRIMARY KEY ("id")
)

CREATE TABLE "public"."User" (
"email" text   NOT NULL DEFAULT E'unset@monet.com',
"name" text   NOT NULL DEFAULT E'unset',
"phone" text   ,
"password" text   DEFAULT E'unset',
"level" integer   NOT NULL DEFAULT 0,
PRIMARY KEY ("email")
)

CREATE TABLE "public"."Project" (
"id" text   NOT NULL DEFAULT E'unset',
"description" text   ,
"agreement" text   ,
"public" integer   NOT NULL DEFAULT 0,
"userEmail" text   ,
"name" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Result" (
"experimentId" text   ,
"projectId" text   ,
"timestamp" text   ,
"id" text   NOT NULL DEFAULT E'unset',
"done" integer   NOT NULL DEFAULT 0,
"userEmail" text   ,
"json" text   DEFAULT E'{}',
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_ExperimentToProject" (
"A" text   NOT NULL ,
"B" text   NOT NULL
)

CREATE UNIQUE INDEX "_ExperimentToProject_AB_unique" ON "public"."_ExperimentToProject"("A", "B")

CREATE INDEX "_ExperimentToProject_B_index" ON "public"."_ExperimentToProject"("B")

ALTER TABLE "public"."Experiment" ADD FOREIGN KEY ("userEmail")REFERENCES "public"."User"("email") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Project" ADD FOREIGN KEY ("userEmail")REFERENCES "public"."User"("email") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Result" ADD FOREIGN KEY ("experimentId")REFERENCES "public"."Experiment"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Result" ADD FOREIGN KEY ("projectId")REFERENCES "public"."Project"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Result" ADD FOREIGN KEY ("userEmail")REFERENCES "public"."User"("email") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_ExperimentToProject" ADD FOREIGN KEY ("A")REFERENCES "public"."Experiment"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ExperimentToProject" ADD FOREIGN KEY ("B")REFERENCES "public"."Project"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200901042124-psql1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,57 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Experiment {
+  id          String    @default("unset") @id
+  userEmail   String?
+  name        String    @default("unset")
+  description String?
+  fileId      String    @default("unset")
+  fileName    String?
+  json        String?   @default("{}")
+  User        User?     @relation(fields: [userEmail], references: [email])
+  Result      Result[]
+  Project     Project[]
+}
+
+model User {
+  email      String       @default("unset@monet.com") @id
+  name       String       @default("unset")
+  phone      String?
+  password   String?      @default("unset")
+  level      Int          @default(0)
+  Experiment Experiment[]
+  Project    Project[]
+  Result     Result[]
+}
+
+model Project {
+  id          String       @default("unset") @id
+  description String?
+  agreement   String?
+  public      Int          @default(0)
+  userEmail   String?
+  name        String?
+  User        User?        @relation(fields: [userEmail], references: [email])
+  Result      Result[]
+  Experiment  Experiment[]
+}
+
+model Result {
+  experimentId String?
+  projectId    String?
+  timestamp    String?
+  id           String      @default("unset") @id
+  done         Int         @default(0)
+  userEmail    String?
+  json         String?     @default("{}")
+  Experiment   Experiment? @relation(fields: [experimentId], references: [id])
+  Project      Project?    @relation(fields: [projectId], references: [id])
+  User         User?       @relation(fields: [userEmail], references: [email])
+}
```
